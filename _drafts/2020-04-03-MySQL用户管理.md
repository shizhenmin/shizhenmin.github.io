---
title: MySQL用户管理
categories: 数据库
tags: mysql
---

* content
{:toc}


## 设置密码

### 初始密码



### 重置密码

在shell命令行中修改密码：

```
mysqladmin -hlocalhost -uroot -p password "新密码"
```



```
SET PASSWORD = PASSWORD('新密码');
SET PASSWORD FOR 用户名@'客户端地址' = PASSWORD('新密码');
```





4 种



### 忘记密码

1、修改配置文件 `/etc/my.cnf`，配置文件也可能是 `/etc/mysql/my.cnf`

在 `[mysqld]` 下一行加上

```
skip-grant-tables
```

2、重启 mysql

```
systemctl restart mysqld
```

3、在mysql中修改密码

```SQL
update mysql.user set authentication_string=password("新密码") where user='root' and host='localhost';
flush privileges;
quit;
```

4、将配置文件改回来

5、重启 mysql



## 管理用户

### 创建用户

```sql
CREATE USER 用户名 IDENTIFIED BY '密码';
```



### 用户重命名

```sql
RENAME USER 旧用户名 TO 新用户名;
```



### 删除用户

```sql
DROP USER 用户名;
```



## 用户授权

授权库 `mysql` 主要的几个表：

| 表名         | 作用                           |
| ------------ | ------------------------------ |
| user         | 存储授权用户的访问权限         |
| db           | 存储授权用户对数据库的访问权限 |
| tables_priv  | 存储授权用户对表的访问权限     |
| columns_priv | 存储授权用户对字段的访问权限   |



### 创建授权

基本用法

```sql
GRANT 权限列表
  ON 库名.表名 
  TO 用户名@'客户端地址'
  IDENTIFIED BY '密码'
  [WITH GRANT OPTION];
```

<br>

权限列表

* `all` 匹配所有权限
* `select`，`update`，`insert` ...
* `select`，`update(字段1, ... , 字段N)`

<br>

客户端地址

* `%` 匹配所有主机
* `192.168.1.1` 匹配单个IP
* `192.168.1.%` 匹配网段



### 查看授权

```SQL
SHOW GRANTS;
SHOW GRANTS FOR 用户名@'客户端地址';
```



### 撤销用户权限

```
REVOKE 权限列表 ON 库名.表名
  FROM 用户名@'客户端地址';
```













