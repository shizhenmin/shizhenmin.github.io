---
title: 浙大远程连接指南
categories: 技术
tags: 技术
---

* content
{:toc}
介绍不同的远程连接方式。




## TeamViewer

说到远程连接，TeamViewer应该是大家都知道的一款远程连接软件，但我个人平时不怎么用它，因此下面的教程我就简要地写写它的使用方法。



### 连接

TeamViewer 可以不安装直接使用，但为了获得更多功能，还是推荐安装。

下面是 TeamViewer 安装后，运行时的界面

![TeamViewer_1.png](/images/tech/remote_connnection/TeamViewer_1.png)

左边是自己的ID和密码，右边输入伙伴ID，在弹出的窗口中输入伙伴的密码，即可远程连接到对应电脑

同理，要想在另一台电脑连接到这台电脑，需要记下这台电脑的ID和密码。这个密码为随机密码，每次启动软件时密码都会更新，因此个人使用时有必要设置固定的密码。



### 设置个人密码

点击密码右边看起来像刷新的图标（鼠标移到相应位置才会出现），点击设置个人密码，就可以设置固定的密码了。

![TeamViewer_2.png](/images/tech/remote_connnection/TeamViewer_2.png)

![TeamViewer_3.png](/images/tech/remote_connnection/TeamViewer_3.png)

现在就可以通过这个密码进行访问了。



### 授权轻松访问

授权轻松访问后，无需密码就能直接登录远程的电脑。开启这个功能也很简单，在主界面勾选轻松访问即可

![TeamViewer_4.png](/images/tech/remote_connnection/TeamViewer_4.png)



### 保持启动状态

首先讲一下开机启动，在软件的界面上勾选 `随Windows一同启动TeamViewer` 就可以实现开机启动。

另外，我觉得也有必要做个计划任务，保持 TeamViewer 的开启状态。有时远程连接结束时，想要关闭本地的 TeamViewer，结果手误将远程的 TeamViewer 给关了，那远程的电脑就彻底失联了。创建计划任务，可以参考我的上一篇博客 [浙大联网指南](/2020/06/06/浙大联网指南)，这里就不介绍了。



### 跨平台使用

![TeamViewer_5.png](/images/tech/remote_connnection/TeamViewer_5.png)

也可以在手机、平板上使用 TeamViewer，只不过操作有点不方便。



### 缺点

1、TeamViewer只能用于非商业用途。但有时我们个人使用时，系统也会判定我们把软件用于商业用途，导致使用受到限制。账号被限制后，每次远程连接的时间很短，连接很快会被断开。如果遇到被误判的情况，可以给客服发邮件说明情况，如果情况属实，账号的限制是能被解除的。

2、在两台电脑上安装的 TeamViewer 版本要一致，否则无法相互连接。不过这个问题只要时常更新就可以解决。

3、使用 TeamViewer 远程连接时，被远程的电脑上是会显示我们的操作的。如果远程电脑的屏幕是开着的，自己的骚操作被别人看到~~（学会）~~还好，遇到一个调皮的师弟，在你操作时偷偷关掉你的软件，然后告诉你电脑中病毒了，那可就麻烦了。

接下来，就介绍一个“更安全”的远程连接方式。



## 远程桌面连接mstsc

Windows 系统自带一个远程连接软件：`远程桌面连接(mstsc)`，不过这个功能需要在 Windows 专业版中才能使用。使用 mstsc 连接电脑后，被连接的电脑会自动进入锁定状态，这样就可以避免出现远程电脑同时也被别人操作的尴尬场景。



### 连接

远程桌面连接在 Windows 附件中

![mstsc_1.png](/images/tech/remote_connnection/mstsc_1.png)

或者可以直接按快捷键 `WIN + R` 调出运行窗口，输入 `mstsc`

![mstsc_2.png](/images/tech/remote_connnection/mstsc_2.png)

打开远程桌面连接后，输入IP地址

![mstsc_3.png](/images/tech/remote_connnection/mstsc_3.png)

再输入用户名和密码，即可远程连接到另一台电脑上。

![mstsc_4.png](/images/tech/remote_connnection/mstsc_4.png)

![mstsc_5.png](/images/tech/remote_connnection/mstsc_5.png)

如果远程连接失败，需要先进行下面的一些设置。



### 设置账户密码

如果远程电脑的windows账户没有密码，需要先给账户创建密码。在 `设置` -> `账户` -> `登录选项` -> `密码` 中添加密码

![mstsc_6.png](/images/tech/remote_connnection/mstsc_6.png)



### 允许远程连接

如果远程连接时出现下面的报错信息：

![mstsc_7.png](/images/tech/remote_connnection/mstsc_7.png)

可能是因为没有远程电脑没有开启远程的权限，打开 `控制面板` -> `系统和安全` -> `系统` -> `远程设置`

![mstsc_8.png](/images/tech/remote_connnection/mstsc_8.png)

在 `远程` 中进行如下设置

![mstsc_9.png](/images/tech/remote_connnection/mstsc_9.png)



### 获取远程电脑IP

和 TeamViewer 的固定ID不同，使用mstsc远程登录需要获得远程电脑的IP，而IP地址在每次联网之后又总是会发生改变。因此获得远程电脑的IP地址十分重要。

在windows系统中，`ipconfig` 命令能获取当前电脑的IP配置。在远程电脑上运行 `ipconfig` 命令，将输出写入到一个文件中，再通过 OneDrive 等同步软件将该文件同步到本地电脑，就可以知道远程电脑的IP了。

但如何在远程电脑上运行 `ipconfig` 命令呢？在我的上一篇博客 [浙大联网指南](/2020/06/06/浙大联网指南) 中其实已经展示了相关代码：

```batch
:loop
rasdial ZJUVPN 21816092 password
if %errorlevel% == 0 goto label
goto:loop

:label
ipconfig > "D:\OneDrive - zju.edu.cn\11_connect\Dell-ip.txt"
```

第七行的命令是将IP地址写入到文件中。并且这个命令在每次网络重新连接之后都会执行一遍，这样就能保证IP地址都是最新的。



### 实际使用

在浙大校园内，笔记本连接WiFi时，IP地址是 `10.*.*.*` 的本地地址，而使用网线连接的台式机的IP通常为归属于浙江大学的公网IP，但在校外ping不通这个IP。因此如果想要连接实验室的电脑，直接使用 mstsc，就只能在校内进行访问。在校外需要连接连接实验室电脑的话，则要先登录浙大rVPN。

不过 mstsc 有一个优点，就是在同一局域网内，两台电脑不需要连接外网即可相互访问。



### 缺点

1、Windows 家庭版不能使用

2、使用较为繁琐

3、在校外需要配合rVPN使用



### 其他错误

![mstsc_10.png](/images/tech/remote_connnection/mstsc_10.png)

运行 gpedit.msc

本地组策略：

计算机配置>管理模板>系统>凭据分配>加密Oracle修正

选择启用并选择易受攻击。



## Linux连接Windows

做好上面的那些设置，一般情况下都可以做到在宿舍、在家里随时访问在实验室的电脑。但在今年疫情中，我还是翻车了。TeamViewer 是由于上面提到的版本不一致，导致无法连接。使用 mstsc 则是因为IP地址ping不通而无法连接。通常情况下，使用rvpn后，就获得了浙大的本地IP地址，就可以连接ping通归属与浙大的IP了，但寒假里，不知道为什么这样的方式一直行不通。

所以，我又想了另一种更加稳定的远程连接方式。

实验室的台式机总是插着网线，因此总是拥有 `192.168.1.*` 的本地IP地址，所以总能ping通实验室的服务器，而实验室的服务器在假期中又会配置端口映射，可以通过浙大内部的网络进行访问。反过来，不就可以在连接浙大的rvpn后，登录到实验室的服务器上，再通过服务器来远程连接自己的电脑吗？

接下来就介绍利用Linux连接Windows的方法。



### Ubuntu Server安装图形化界面

安装图形化界面

```bash
sudo apt-get install -y lightdm
sudo apt-get install -y ubuntu-desktop
```

切换图形化

```bash
# 启动图形化
sudo service lightdm start
# 关闭图形化
sudo service lightdm stop
```



### 安装freerdp

```bash
sudo apt-get install -y freerdp2-x11
```



### 使用freerdp

连接时需要指定IP、用户名和密码：

```bash
xfreerdp /v:192.168.2.128 /u:zhangsan /p:123456
```

另外有几点需要注意：

1、Linux系统需要开启图形化

2、ssh软件需要支持图形化

如果没有图形化的支持，使用这种方法在Linux上连接Windows就会失败。



参考网站：

[TeamViewer远程的三种访问模式](https://my.oschina.net/u/3477605/blog/1798601)

[Ubuntu Server的图形化界面](https://blog.csdn.net/qq_23034515/article/details/88568086)

[freerdp配置](https://www.jianshu.com/p/f6fcf5b56fe3)